package clear.i_read.fragment;


import java.util.Calendar;
import java.util.TimeZone;
import java.util.concurrent.TimeUnit;

import android.content.ContentValues;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.text.format.Time;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.ImageView;
import clear.i_read.R;

import com.tyczj.extendedcalendarview.CalendarProvider;
import com.tyczj.extendedcalendarview.Event;

@SuppressWarnings("deprecation")
public class ReviewFragment extends Fragment {

	private Button btn_ok;

	@Override
	public View onCreateView(LayoutInflater inflater, ViewGroup container,
			Bundle savedInstanceState) {

		View view = inflater.inflate(R.layout.review_form, container, false);
		
		Bitmap image = (Bitmap) getActivity().getIntent()
				.getParcelableExtra("image");

		ImageView imageView = (ImageView) view.findViewById(R.id.image);
		imageView.setImageBitmap(image);
		

		btn_ok = (Button) view.findViewById(R.id.btn_good);
		btn_ok.setOnClickListener(new OnClickListener() {

			@Override
			public void onClick(View v) {
				save();
			}
		});

		return view;
	}


	private void save() {

		ContentValues values = new ContentValues();
		values.put(CalendarProvider.COLOR, Event.COLOR_GREEN);
		values.put(CalendarProvider.DESCRIPTION, "Some Description");
		values.put(CalendarProvider.LOCATION, "Some location");
		values.put(CalendarProvider.EVENT, "Event name");

		Calendar cal = Calendar.getInstance();
		TimeZone tz = TimeZone.getDefault();

		int dayJulian = Time.getJulianDay(cal.getTimeInMillis(),
				TimeUnit.MILLISECONDS.toSeconds(tz.getOffset(cal.getTimeInMillis())));
		
		values.put(CalendarProvider.START, cal.getTimeInMillis());
		values.put(CalendarProvider.START_DAY, dayJulian);
		values.put(CalendarProvider.END, cal.getTimeInMillis());
		values.put(CalendarProvider.END_DAY, dayJulian);

		getActivity().getContentResolver().insert(CalendarProvider.CONTENT_URI, values);

	}
}
